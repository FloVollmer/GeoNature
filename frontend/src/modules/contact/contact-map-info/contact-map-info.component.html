<div class="row row-sm">
  <div class="col-sm-12 col-md-5 padding-sm">
      <pnx-map class="map-card"> </pnx-map>
  </div>
  <div class="col-sm-12 col-md-7 padding-sm">
    <div class="card">
      <div class="card-header">
              <h4 > Relevé
                 <i mdTooltip="Edit relevé {{id}}"
                  class="fa fa-pencil-square-o fa-lg toolbar-spacer"
                  aria-hidden="true" 
                  (click)="onEditReleve(id)">
                </i>
                <i class="fa fa-list"
                 aria-hidden="true"
                 mdTooltip="Retour à la liste"
                 (click)="backToList()">
                </i>
                
                </h4>
      </div>

      <div class="card-block releve">
        <b> Relevé numéro </b>: {{releve?.id}} <b> Observateurs </b>: {{observers}} <br>
        <b> Communnes </b>: {{municipalities}} <br>
        <b> Entre le  </b>: {{dateMin}}  <b> et le </b>: {{dateMax}} <br>
        <b> Altitude min  </b>: {{releve?.properties.altitude_min }}<b> Altitude max  </b>: {{releve?.properties.altitude_max }} <br>

          <label> Taxons observé(s): </label>
          <div >
              <img *ngIf="showSpinner" src="assets/images/spinner.gif" 
              id="il_fi" 
              alt="Chargement..." 
              height="70" 
              width="70">
          </div>
          <div *ngIf="!showSpinner">
            <table class="table table-hover ">
              <tr [ngClass]="{'table-warning': i == selectedIndex}" *ngFor="let occ of releve?.properties.t_occurrences_contact; let i = index" 
              (click)="selectOccurrence(occ, i)">
                <td class="selected-taxon">{{occ.taxon?.nom_complet}}</td>
              </tr>
            </table>
          </div>

    </div>    
    </div>
    
    <div *ngIf="selectedOccurrence" class="card info-occurrence">
      <label class="card-header"> <b> Détails: </b>  {{selectedOccurrence?.taxon?.nom_valide}} </label>
      <div class="card-block">
        <ul class="nav nav-tabs" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#occurrence" role="tab">Info observation</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#counting" role="tab">Dénombrement</a>
          </li>
        </ul>
        <!-- OCCURRENCE -->
        <!-- Tab panes -->
        <div class="tab-content">
          <div class="tab-pane active" id="occurrence" role="tabpanel">
            <div class="row row-sm">
              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                <pnx-nomenclature 
                [parentFormControl]="occurrenceForm.controls.id_nomenclature_obs_technique"
                placeholder="{{ 'Taxon.ObsTechnique' | translate }}" 
                [idTypeNomenclature]="100"
                [disabled]="disabled">
              </pnx-nomenclature>
              </div>
              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                  <pnx-nomenclature 
                    placeholder="{{ 'Taxon.ObsMethod' | translate }}"
                    [parentFormControl]="occurrenceForm.controls.id_nomenclature_obs_meth"
                    [idTypeNomenclature]="14" 
                    [disabled]="disabled">
                  </pnx-nomenclature>
              </div>
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                  <pnx-nomenclature 
                    placeholder="{{ 'Taxon.BiologicalCondition' | translate }}"
                    [parentFormControl]="occurrenceForm.controls.id_nomenclature_bio_condition"
                    [idTypeNomenclature]="7" 
                    [disabled]="disabled" > 
                  </pnx-nomenclature>
                </div>
              </div>
              <div class="row row-sm">
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                    <pnx-nomenclature 
                      placeholder="{{ 'Taxon.BiologicalStatus' | translate }}"
                      [parentFormControl]="occurrenceForm.controls.id_nomenclature_bio_status"
                      [idTypeNomenclature]="13" 
                      [disabled]="disabled"> 
                    </pnx-nomenclature> 
                  </div>          
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                    <pnx-nomenclature 
                      placeholder="{{ 'Taxon.Naturalness' | translate }}"
                      [parentFormControl]="occurrenceForm.controls.id_nomenclature_naturalness"
                      [idTypeNomenclature]="8" 
                      [disabled]="disabled">
                    </pnx-nomenclature>
                  </div>
                  <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                      <small> {{ 'Taxon.DeterminationMethod' | translate }} </small>
                    <input class="form-control form-control-sm" 
                      [formControl]="occurrenceForm.controls.determination_method"
                      [disableControl]="disabled"
                      type="text">
                  </div>
                </div>
          
                <div class="row row-sm">
                  <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                      <small> {{ 'Taxon.Determiner' | translate }} </small>
                      <input class="form-control form-control-sm"
                      [formControl]="occurrenceForm.controls.determiner"
                      [disableControl]="disabled"
                        type="text">
                  </div>
                  <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4"> 
                    <pnx-nomenclature 
                      placeholder="{{ 'Taxon.ValidationStatus' | translate }}"
                      [parentFormControl]="occurrenceForm.controls.id_nomenclature_exist_proof"
                      [idTypeNomenclature]="101" 
                      [disabled]="disabled">
                    </pnx-nomenclature>
                  </div>
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                      <pnx-nomenclature 
                        placeholder="{{ 'Taxon.ExistProof' | translate }}"
                        [parentFormControl]="occurrenceForm.controls.id_nomenclature_exist_proof"
                        [idTypeNomenclature]="15" 
                        [disabled]="disabled">
                      </pnx-nomenclature>
                    </div>
                </div>
          
                <div class="row row-sm">
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4 form-group">
                      <small> {{ 'Taxon.DigitalProof' | translate }} </small>
                      <input class="form-control form-control-sm"
                      [formControl]="occurrenceForm.controls.digital_proof"
                      [disableControl]="disabled"
                        type="text">
                  </div>
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                    <small> {{ 'Taxon.NonDigitalProof' | translate }} </small>
                    <input class="form-control form-control-sm"
                    [formControl]="occurrenceForm.controls.non_digital_proof"
                    [disableControl]="disabled"
                      type="text"> 
                  </div>
                </div>

                <div class="row row-sm form-group" id="row-commentaire">
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">               
                      <textarea placeholder="{{ 'Releve.Comment' | translate }}"
                      class="form-control" [formControl]="occurrenceForm.controls.comment" 
                        rows="2"
                        id="commentaire"
                        [disableControl]="disabled">
                      </textarea>
                  </div>
                </div>

          </div>
          <!-- denombrement -->
          <div class="tab-pane" id="counting" role="tabpanel">
            <div *ngFor="let counting of selectedOccurrence?.cor_counting_contact; let index = index">
                <div class="row row-sm">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4 col-counting">
                        <pnx-nomenclature
                          placeholder="{{ 'Counting.LifeStage' | translate }}" 
                          [parentFormControl]="countingFormArray.controls[index].controls.id_nomenclature_life_stage"
                          [idTypeNomenclature]="10"
                          [disabled]="disabled"> 
                        </pnx-nomenclature>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-3 col-counting">
                        <pnx-nomenclature
                          placeholder="{{ 'Counting.Sex' | translate }}"
                          [parentFormControl]="countingFormArray.controls[index].controls.id_nomenclature_sex"
                          [idTypeNomenclature]="9"
                          [disabled]="disabled">
                        </pnx-nomenclature>
                  </div>
                  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-5 col-counting">
                        <pnx-nomenclature 
                          placeholder="{{ 'Counting.CountingObject' | translate }}"
                          [parentFormControl]="countingFormArray.controls[index].controls.id_nomenclature_obj_count"
                          [idTypeNomenclature]="6"
                          [disabled]="disabled" >
                        </pnx-nomenclature>
                  </div>
            
                </div>
                <div class="form-group row row-sm">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-5 col-counting">
                        <pnx-nomenclature
                          #typeDenombrement
                          placeholder="{{ 'Counting.CountingType' | translate }}"
                          [parentFormControl]="countingFormArray.controls[index].controls.id_nomenclature_type_count"
                          [idTypeNomenclature]="21"
                          [disabled]="disabled">
                        </pnx-nomenclature> 
                  </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-3 col-counting">
                      <div class="form-group" [ngClass]="{'has-danger' : countingFormArray.controls[index].controls.count_min.invalid}">
                        <small> {{ 'Counting.NumberMin' | translate }} </small>
                        <input class="form-control form-control-sm" type="number" 
                        [formControl]="countingFormArray.controls[index].controls.count_min"
                        [disableControl]="disabled">
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-3 col-counting">
                      <div class="form-group" [ngClass]="{'has-danger' : countingFormArray.controls[index].controls.count_max.invalid}">
                          <small> {{ 'Counting.NumberMax' | translate }} </small>
                        <input class="form-control form-control-sm" type="number" 
                        [formControl]="countingFormArray.controls[index].controls.count_max"
                        [disableControl]="disabled">
                      </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-1 col-counting" *ngIf="index == length -1 && index != 0">
                      <button id="add-counting" type="button" class="btn btn-danger btn-sm" (click)="onRemoveCounting(index)">
                          <i class="fa fa-times" aria-hidden="true"></i>
                      </button>
                    </div>
                </div>
                <hr>
          
                </div>
                
            </div>
          </div>
      <!-- end tab -->
        </div>
      </div>  
      <!-- end card selected -->
  </div>
</div>
